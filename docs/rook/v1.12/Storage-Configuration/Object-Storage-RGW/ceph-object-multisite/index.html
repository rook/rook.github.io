<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Rook Ceph Documentation"><meta name=author content="Rook Authors"><link href=https://rook.io/v1.12/Storage-Configuration/Object-Storage-RGW/ceph-object-multisite/ rel=canonical><link rel=icon href=https://rook.io/images/favicon_192x192.png><meta name=generator content="mkdocs-1.5.2, mkdocs-material-8.5.10"><title>Object Store Multisite - Rook Ceph Documentation</title><link rel=stylesheet href=../../../assets/stylesheets/main.975780f9.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.2505c338.min.css><link rel=stylesheet href=../../../stylesheets/extra.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=rook-blue data-md-color-accent=deep-orange> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#prerequisites class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-component=outdated hidden> <aside class="md-banner md-banner--warning"> <div class="md-banner__inner md-grid md-typeset"> This documentation is not for the latest stable version of Rook. <a href=../../../../latest-release/ > <strong>Click here for the latest release documentation.</strong> </a> </div> <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script> </aside> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="Rook Ceph Documentation" class="md-header__button md-logo" aria-label="Rook Ceph Documentation" data-md-component=logo> <img src=https://rook.io/images/rook-logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Rook Ceph Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Object Store Multisite </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=rook-blue data-md-color-accent=deep-orange aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=rook-blue data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/rook/rook title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../Getting-Started/intro/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../../../Helm-Charts/helm-charts/ class=md-tabs__link> Helm Charts </a> </li> <li class=md-tabs__item> <a href=../../Block-Storage-RBD/block-storage/ class="md-tabs__link md-tabs__link--active"> Storage Configuration </a> </li> <li class=md-tabs__item> <a href=../../../CRDs/Cluster/ceph-cluster-crd/ class=md-tabs__link> Custom Resources </a> </li> <li class=md-tabs__item> <a href=../../../Troubleshooting/krew-plugin/ class=md-tabs__link> Troubleshooting </a> </li> <li class=md-tabs__item> <a href=../../../Upgrade/health-verification/ class=md-tabs__link> Upgrade </a> </li> <li class=md-tabs__item> <a href=../../../Contributing/development-flow/ class=md-tabs__link> Contributing </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="Rook Ceph Documentation" class="md-nav__button md-logo" aria-label="Rook Ceph Documentation" data-md-component=logo> <img src=https://rook.io/images/rook-logo.svg alt=logo> </a> Rook Ceph Documentation </label> <div class=md-nav__source> <a href=https://github.com/rook/rook title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_1 type=checkbox id=__nav_1 checked> <label class=md-nav__link for=__nav_1> Getting Started <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Getting Started" data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Getting-Started/intro/ class=md-nav__link> Rook </a> </li> <li class=md-nav__item> <a href=../../../Getting-Started/glossary/ class=md-nav__link> Glossary </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_1_3 type=checkbox id=__nav_1_3 checked> <label class=md-nav__link for=__nav_1_3> Prerequisites <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Prerequisites data-md-level=2> <label class=md-nav__title for=__nav_1_3> <span class="md-nav__icon md-icon"></span> Prerequisites </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Getting-Started/Prerequisites/prerequisites/ class=md-nav__link> Prerequisites </a> </li> <li class=md-nav__item> <a href=../../../Getting-Started/Prerequisites/authenticated-registry/ class=md-nav__link> Authenticated Container Registries </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../Getting-Started/quickstart/ class=md-nav__link> Quickstart </a> </li> <li class=md-nav__item> <a href=../../../Getting-Started/storage-architecture/ class=md-nav__link> Storage Architecture </a> </li> <li class=md-nav__item> <a href=../../../Getting-Started/example-configurations/ class=md-nav__link> Example Configurations </a> </li> <li class=md-nav__item> <a href=../../../Getting-Started/ceph-openshift/ class=md-nav__link> OpenShift </a> </li> <li class=md-nav__item> <a href=../../../Getting-Started/ceph-teardown/ class=md-nav__link> Cleanup </a> </li> <li class=md-nav__item> <a href=../../../Getting-Started/release-cycle/ class=md-nav__link> Release Cycle </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2> Helm Charts <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Helm Charts" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Helm Charts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Helm-Charts/helm-charts/ class=md-nav__link> Helm Charts Overview </a> </li> <li class=md-nav__item> <a href=../../../Helm-Charts/operator-chart/ class=md-nav__link> Ceph Operator Helm Chart </a> </li> <li class=md-nav__item> <a href=../../../Helm-Charts/ceph-cluster-chart/ class=md-nav__link> Ceph Cluster Helm Chart </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> Storage Configuration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Storage Configuration" data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Storage Configuration </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_3_1 type=checkbox id=__nav_3_1 checked> <label class=md-nav__link for=__nav_3_1> Block Storage (RBD) <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Block Storage (RBD)" data-md-level=2> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> Block Storage (RBD) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Block-Storage-RBD/block-storage/ class=md-nav__link> Block Storage Overview </a> </li> <li class=md-nav__item> <a href=../../Block-Storage-RBD/rbd-mirroring/ class=md-nav__link> RBD Mirroring </a> </li> <li class=md-nav__item> <a href=../../Block-Storage-RBD/rbd-async-disaster-recovery-failover-failback/ class=md-nav__link> RBD Asynchronous DR Failover and Failback </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2 checked> <label class=md-nav__link for=__nav_3_2> Shared Filesystem (CephFS) <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Shared Filesystem (CephFS)" data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Shared Filesystem (CephFS) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Shared-Filesystem-CephFS/filesystem-storage/ class=md-nav__link> Filesystem Storage Overview </a> </li> <li class=md-nav__item> <a href=../../Shared-Filesystem-CephFS/filesystem-mirroring/ class=md-nav__link> Filesystem Mirroring </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3 checked> <label class=md-nav__link for=__nav_3_3> Object Storage (RGW) <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Object Storage (RGW)" data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Object Storage (RGW) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../object-storage/ class=md-nav__link> Object Storage Overview </a> </li> <li class=md-nav__item> <a href=../ceph-object-bucket-claim/ class=md-nav__link> Bucket Claim </a> </li> <li class=md-nav__item> <a href=../ceph-object-bucket-notifications/ class=md-nav__link> Object Bucket Notifications </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Object Store Multisite <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Object Store Multisite </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#prerequisites class=md-nav__link> Prerequisites </a> </li> <li class=md-nav__item> <a href=#creating-object-multisite class=md-nav__link> Creating Object Multisite </a> </li> <li class=md-nav__item> <a href=#pulling-a-realm class=md-nav__link> Pulling a Realm </a> <nav class=md-nav aria-label="Pulling a Realm"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#getting-the-pull-endpoint class=md-nav__link> Getting the Pull Endpoint </a> </li> <li class=md-nav__item> <a href=#getting-realm-access-key-and-secret-key class=md-nav__link> Getting Realm Access Key and Secret Key </a> <nav class=md-nav aria-label="Getting Realm Access Key and Secret Key"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#getting-the-realm-access-key-and-secret-key-from-the-rook-ceph-cluster class=md-nav__link> Getting the Realm Access Key and Secret Key from the Rook Ceph Cluster </a> <nav class=md-nav aria-label="Getting the Realm Access Key and Secret Key from the Rook Ceph Cluster"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#system-user-for-multisite class=md-nav__link> System User for Multisite </a> </li> <li class=md-nav__item> <a href=#getting-keys-from-k8s-secret class=md-nav__link> Getting keys from k8s secret </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#getting-the-realm-access-key-and-secret-key-from-a-non-rook-ceph-cluster class=md-nav__link> Getting the Realm Access Key and Secret Key from a Non Rook Ceph Cluster </a> </li> <li class=md-nav__item> <a href=#pulling-a-realm-on-a-new-rook-ceph-cluster class=md-nav__link> Pulling a Realm on a New Rook Ceph Cluster </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#scaling-a-multisite class=md-nav__link> Scaling a Multisite </a> </li> <li class=md-nav__item> <a href=#multisite-cleanup class=md-nav__link> Multisite Cleanup </a> <nav class=md-nav aria-label="Multisite Cleanup"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#realm-deletion class=md-nav__link> Realm Deletion </a> <nav class=md-nav aria-label="Realm Deletion"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#deleting-a-realm class=md-nav__link> Deleting a Realm </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#zone-group-deletion class=md-nav__link> Zone Group Deletion </a> <nav class=md-nav aria-label="Zone Group Deletion"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#deleting-a-zone-group class=md-nav__link> Deleting a Zone Group </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#deleting-and-reconfiguring-the-ceph-object-zone class=md-nav__link> Deleting and Reconfiguring the Ceph Object Zone </a> <nav class=md-nav aria-label="Deleting and Reconfiguring the Ceph Object Zone"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#changing-the-master-zone class=md-nav__link> Changing the Master Zone </a> </li> <li class=md-nav__item> <a href=#deleting-zone class=md-nav__link> Deleting Zone </a> </li> <li class=md-nav__item> <a href=#deleting-pools-for-a-zone class=md-nav__link> Deleting Pools for a Zone </a> </li> <li class=md-nav__item> <a href=#removing-an-object-store-from-a-zone class=md-nav__link> Removing an Object Store from a Zone </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#configure-an-existing-object-store-for-multisite class=md-nav__link> Configure an Existing Object Store for Multisite </a> <nav class=md-nav aria-label="Configure an Existing Object Store for Multisite"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#using-custom-names class=md-nav__link> Using custom names </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../cosi/ class=md-nav__link> Container Object Storage Interface (COSI) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4 checked> <label class=md-nav__link for=__nav_3_4> NFS <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=NFS data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> NFS </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../NFS/nfs/ class=md-nav__link> NFS Storage Overview </a> </li> <li class=md-nav__item> <a href=../../NFS/nfs-csi-driver/ class=md-nav__link> CSI provisioner and driver </a> </li> <li class=md-nav__item> <a href=../../NFS/nfs-security/ class=md-nav__link> Security </a> </li> <li class=md-nav__item> <a href=../../NFS/nfs-advanced/ class=md-nav__link> Advanced configuration </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_3_5 type=checkbox id=__nav_3_5 checked> <label class=md-nav__link for=__nav_3_5> Monitoring <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Monitoring data-md-level=2> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Monitoring </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Monitoring/ceph-dashboard/ class=md-nav__link> Ceph Dashboard </a> </li> <li class=md-nav__item> <a href=../../Monitoring/ceph-monitoring/ class=md-nav__link> Prometheus Monitoring </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_3_6 type=checkbox id=__nav_3_6 checked> <label class=md-nav__link for=__nav_3_6> Ceph CSI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Ceph CSI" data-md-level=2> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Ceph CSI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Ceph-CSI/ceph-csi-drivers/ class=md-nav__link> Ceph CSI Drivers </a> </li> <li class=md-nav__item> <a href=../../Ceph-CSI/ceph-csi-snapshot/ class=md-nav__link> Snapshots </a> </li> <li class=md-nav__item> <a href=../../Ceph-CSI/ceph-csi-volume-clone/ class=md-nav__link> Volume clone </a> </li> <li class=md-nav__item> <a href=../../Ceph-CSI/custom-images/ class=md-nav__link> Custom Images </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../ceph-teardown/ class=md-nav__link> Cleanup </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_3_8 type=checkbox id=__nav_3_8 checked> <label class=md-nav__link for=__nav_3_8> Advanced <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Advanced data-md-level=2> <label class=md-nav__title for=__nav_3_8> <span class="md-nav__icon md-icon"></span> Advanced </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Advanced/ceph-configuration/ class=md-nav__link> Ceph Configuration </a> </li> <li class=md-nav__item> <a href=../../Advanced/configuration/ class=md-nav__link> Configuration </a> </li> <li class=md-nav__item> <a href=../../Advanced/key-management-system/ class=md-nav__link> Key Management System </a> </li> <li class=md-nav__item> <a href=../../Advanced/ceph-osd-mgmt/ class=md-nav__link> Ceph OSD Management </a> </li> <li class=md-nav__item> <a href=../../Advanced/ceph-mon-health/ class=md-nav__link> Monitor Health </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_4 type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4> Custom Resources <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Custom Resources" data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Custom Resources </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_4_1 type=checkbox id=__nav_4_1 checked> <label class=md-nav__link for=__nav_4_1> Cluster Configuration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Cluster Configuration" data-md-level=2> <label class=md-nav__title for=__nav_4_1> <span class="md-nav__icon md-icon"></span> Cluster Configuration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../CRDs/Cluster/ceph-cluster-crd/ class=md-nav__link> CephCluster CRD </a> </li> <li class=md-nav__item> <a href=../../../CRDs/Cluster/host-cluster/ class=md-nav__link> Host Storage Cluster </a> </li> <li class=md-nav__item> <a href=../../../CRDs/Cluster/pvc-cluster/ class=md-nav__link> PVC Storage Cluster </a> </li> <li class=md-nav__item> <a href=../../../CRDs/Cluster/stretch-cluster/ class=md-nav__link> Stretch Storage Cluster </a> </li> <li class=md-nav__item> <a href=../../../CRDs/Cluster/external-cluster/ class=md-nav__link> External Storage Cluster </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_4_2 type=checkbox id=__nav_4_2 checked> <label class=md-nav__link for=__nav_4_2> Block Storage <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Block Storage" data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Block Storage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../CRDs/Block-Storage/ceph-block-pool-crd/ class=md-nav__link> CephBlockPool CRD </a> </li> <li class=md-nav__item> <a href=../../../CRDs/Block-Storage/ceph-block-pool-rados-namespace-crd/ class=md-nav__link> CephBlockPoolRados Namespace CRD </a> </li> <li class=md-nav__item> <a href=../../../CRDs/Block-Storage/ceph-rbd-mirror-crd/ class=md-nav__link> CephRBDMirror CRD </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_4_3 type=checkbox id=__nav_4_3 checked> <label class=md-nav__link for=__nav_4_3> Shared Filesystem <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Shared Filesystem" data-md-level=2> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Shared Filesystem </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../CRDs/Shared-Filesystem/ceph-filesystem-crd/ class=md-nav__link> CephFilesystem CRD </a> </li> <li class=md-nav__item> <a href=../../../CRDs/Shared-Filesystem/ceph-fs-mirror-crd/ class=md-nav__link> CephFilesystemMirror CRD </a> </li> <li class=md-nav__item> <a href=../../../CRDs/Shared-Filesystem/ceph-fs-subvolumegroup-crd/ class=md-nav__link> FilesystemSubVolumeGroup CRD </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_4_4 type=checkbox id=__nav_4_4 checked> <label class=md-nav__link for=__nav_4_4> Object Storage <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Object Storage" data-md-level=2> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Object Storage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../CRDs/Object-Storage/ceph-object-store-crd/ class=md-nav__link> CephObjectStore CRD </a> </li> <li class=md-nav__item> <a href=../../../CRDs/Object-Storage/ceph-object-store-user-crd/ class=md-nav__link> CephObjectStoreUser CRD </a> </li> <li class=md-nav__item> <a href=../../../CRDs/Object-Storage/ceph-object-realm-crd/ class=md-nav__link> CephObjectRealm CRD </a> </li> <li class=md-nav__item> <a href=../../../CRDs/Object-Storage/ceph-object-zonegroup-crd/ class=md-nav__link> CephObjectZoneGroup CRD </a> </li> <li class=md-nav__item> <a href=../../../CRDs/Object-Storage/ceph-object-zone-crd/ class=md-nav__link> CephObjectZone CRD </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../CRDs/ceph-client-crd/ class=md-nav__link> CephClient CRD </a> </li> <li class=md-nav__item> <a href=../../../CRDs/ceph-nfs-crd/ class=md-nav__link> CephNFS CRD </a> </li> <li class=md-nav__item> <a href=../../../CRDs/specification/ class=md-nav__link> Specification </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_5 type=checkbox id=__nav_5 checked> <label class=md-nav__link for=__nav_5> Troubleshooting <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Troubleshooting data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Troubleshooting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Troubleshooting/krew-plugin/ class=md-nav__link> Krew Plugin </a> </li> <li class=md-nav__item> <a href=../../../Troubleshooting/ceph-toolbox/ class=md-nav__link> Toolbox </a> </li> <li class=md-nav__item> <a href=../../../Troubleshooting/common-issues/ class=md-nav__link> Common Issues </a> </li> <li class=md-nav__item> <a href=../../../Troubleshooting/ceph-common-issues/ class=md-nav__link> Ceph Common Issues </a> </li> <li class=md-nav__item> <a href=../../../Troubleshooting/ceph-csi-common-issues/ class=md-nav__link> CSI Common Issues </a> </li> <li class=md-nav__item> <a href=../../../Troubleshooting/openshift-common-issues/ class=md-nav__link> OpenShift Common Issues </a> </li> <li class=md-nav__item> <a href=../../../Troubleshooting/disaster-recovery/ class=md-nav__link> Disaster Recovery </a> </li> <li class=md-nav__item> <a href=../../../Troubleshooting/direct-tools/ class=md-nav__link> Direct Tools </a> </li> <li class=md-nav__item> <a href=../../../Troubleshooting/performance-profiling/ class=md-nav__link> Performance Profiling </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_6 type=checkbox id=__nav_6 checked> <label class=md-nav__link for=__nav_6> Upgrade <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Upgrade data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Upgrade </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Upgrade/health-verification/ class=md-nav__link> Health Verification </a> </li> <li class=md-nav__item> <a href=../../../Upgrade/rook-upgrade/ class=md-nav__link> Rook Upgrades </a> </li> <li class=md-nav__item> <a href=../../../Upgrade/ceph-upgrade/ class=md-nav__link> Ceph Upgrades </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_7 type=checkbox id=__nav_7 checked> <label class=md-nav__link for=__nav_7> Contributing <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Contributing data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Contributing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Contributing/development-flow/ class=md-nav__link> Development Flow </a> </li> <li class=md-nav__item> <a href=../../../Contributing/development-environment/ class=md-nav__link> Developer Environment </a> </li> <li class=md-nav__item> <a href=../../../Contributing/documentation/ class=md-nav__link> Documentation </a> </li> <li class=md-nav__item> <a href=../../../Contributing/ci-configuration/ class=md-nav__link> CI Configuration </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#prerequisites class=md-nav__link> Prerequisites </a> </li> <li class=md-nav__item> <a href=#creating-object-multisite class=md-nav__link> Creating Object Multisite </a> </li> <li class=md-nav__item> <a href=#pulling-a-realm class=md-nav__link> Pulling a Realm </a> <nav class=md-nav aria-label="Pulling a Realm"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#getting-the-pull-endpoint class=md-nav__link> Getting the Pull Endpoint </a> </li> <li class=md-nav__item> <a href=#getting-realm-access-key-and-secret-key class=md-nav__link> Getting Realm Access Key and Secret Key </a> <nav class=md-nav aria-label="Getting Realm Access Key and Secret Key"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#getting-the-realm-access-key-and-secret-key-from-the-rook-ceph-cluster class=md-nav__link> Getting the Realm Access Key and Secret Key from the Rook Ceph Cluster </a> <nav class=md-nav aria-label="Getting the Realm Access Key and Secret Key from the Rook Ceph Cluster"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#system-user-for-multisite class=md-nav__link> System User for Multisite </a> </li> <li class=md-nav__item> <a href=#getting-keys-from-k8s-secret class=md-nav__link> Getting keys from k8s secret </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#getting-the-realm-access-key-and-secret-key-from-a-non-rook-ceph-cluster class=md-nav__link> Getting the Realm Access Key and Secret Key from a Non Rook Ceph Cluster </a> </li> <li class=md-nav__item> <a href=#pulling-a-realm-on-a-new-rook-ceph-cluster class=md-nav__link> Pulling a Realm on a New Rook Ceph Cluster </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#scaling-a-multisite class=md-nav__link> Scaling a Multisite </a> </li> <li class=md-nav__item> <a href=#multisite-cleanup class=md-nav__link> Multisite Cleanup </a> <nav class=md-nav aria-label="Multisite Cleanup"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#realm-deletion class=md-nav__link> Realm Deletion </a> <nav class=md-nav aria-label="Realm Deletion"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#deleting-a-realm class=md-nav__link> Deleting a Realm </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#zone-group-deletion class=md-nav__link> Zone Group Deletion </a> <nav class=md-nav aria-label="Zone Group Deletion"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#deleting-a-zone-group class=md-nav__link> Deleting a Zone Group </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#deleting-and-reconfiguring-the-ceph-object-zone class=md-nav__link> Deleting and Reconfiguring the Ceph Object Zone </a> <nav class=md-nav aria-label="Deleting and Reconfiguring the Ceph Object Zone"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#changing-the-master-zone class=md-nav__link> Changing the Master Zone </a> </li> <li class=md-nav__item> <a href=#deleting-zone class=md-nav__link> Deleting Zone </a> </li> <li class=md-nav__item> <a href=#deleting-pools-for-a-zone class=md-nav__link> Deleting Pools for a Zone </a> </li> <li class=md-nav__item> <a href=#removing-an-object-store-from-a-zone class=md-nav__link> Removing an Object Store from a Zone </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#configure-an-existing-object-store-for-multisite class=md-nav__link> Configure an Existing Object Store for Multisite </a> <nav class=md-nav aria-label="Configure an Existing Object Store for Multisite"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#using-custom-names class=md-nav__link> Using custom names </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/rook/rook/edit/master/Documentation/Storage-Configuration/Object-Storage-RGW/ceph-object-multisite.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1>Object Store Multisite</h1> <p>Multisite is a feature of Ceph that allows object stores to replicate their data over multiple Ceph clusters.</p> <p>Multisite also allows object stores to be independent and isolated from other object stores in a cluster.</p> <p>When a ceph-object-store is created without the <code>zone</code> section; a realm, zone group, and zone is created with the same name as the ceph-object-store.</p> <p>Since it is the only ceph-object-store in the realm, the data in the ceph-object-store remain independent and isolated from others on the same cluster.</p> <p>When a ceph-object-store is created with the <code>zone</code> section, the ceph-object-store will join a custom created zone, zone group, and realm each with a different names than its own.</p> <p>This allows the ceph-object-store to replicate its data over multiple Ceph clusters.</p> <p>To review core multisite concepts please read the <a href=https://github.com/rook/rook/blob/HEAD/design/ceph/object/ceph-multisite-overview.md>ceph-multisite design overview</a>.</p> <h3 id=prerequisites>Prerequisites<a class=headerlink href=#prerequisites title="Permanent link">&para;</a></h3> <p>This guide assumes a Rook cluster as explained in the <a href=../../../Getting-Started/quickstart/ >Quickstart</a>.</p> <h2 id=creating-object-multisite>Creating Object Multisite<a class=headerlink href=#creating-object-multisite title="Permanent link">&para;</a></h2> <p>If an admin wants to set up multisite on a Rook Ceph cluster, the following resources must be created:</p> <ol> <li>A <a href=../../../CRDs/Object-Storage/ceph-object-realm-crd/#settings>realm</a></li> <li>A <a href=../../../CRDs/Object-Storage/ceph-object-zonegroup-crd/#settings>zonegroup</a></li> <li>A <a href=../../../CRDs/Object-Storage/ceph-object-zone-crd/#settings>zone</a></li> <li>A ceph object store with the <code>zone</code> section</li> </ol> <p>object-multisite.yaml in the <a href=https://github.com/rook/rook/blob/HEAD/deploy/examples/ >examples</a> directory can be used to create the multisite CRDs.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1></a><span class=go>kubectl create -f object-multisite.yaml</span>
</code></pre></div></td></tr></table></div> <p>The first zone group created in a realm is the master zone group. The first zone created in a zone group is the master zone.</p> <p>When a non-master zone or non-master zone group is created, the zone group or zone is not in the Ceph Radosgw Multisite <a href=https://docs.ceph.com/docs/en/latest/radosgw/multisite/ >Period</a> until an object-store is created in that zone (and zone group).</p> <p>The zone will create the pools for the object-store(s) that are in the zone to use.</p> <p>When one of the multisite CRs (realm, zone group, zone) is deleted the underlying ceph realm/zone group/zone is not deleted, neither are the pools created by the zone. See the "Multisite Cleanup" section for more information.</p> <p>For more information on the multisite CRDs, see the related CRDs: - <a href=../../../CRDs/Object-Storage/ceph-object-realm-crd/ >CephObjectRealm</a> - <a href=../../../CRDs/Object-Storage/ceph-object-zonegroup-crd/ >CephObjectZoneGroup</a> - <a href=../../../CRDs/Object-Storage/ceph-object-zone-crd/ >CephObjectZone</a></p> <h2 id=pulling-a-realm>Pulling a Realm<a class=headerlink href=#pulling-a-realm title="Permanent link">&para;</a></h2> <p>If an admin wants to sync data from another cluster, the admin needs to pull a realm on a Rook Ceph cluster from another Rook Ceph (or Ceph) cluster.</p> <p>To begin doing this, the admin needs 2 pieces of information:</p> <ol> <li>An endpoint from the realm being pulled from</li> <li>The access key and the system key of the system user from the realm being pulled from.</li> </ol> <h3 id=getting-the-pull-endpoint>Getting the Pull Endpoint<a class=headerlink href=#getting-the-pull-endpoint title="Permanent link">&para;</a></h3> <p>To pull a Ceph realm from a remote Ceph cluster, an <code>endpoint</code> must be added to the CephObjectRealm's <code>pull</code> section in the <code>spec</code>. This endpoint must be from the master zone in the master zone group of that realm.</p> <p>If an admin does not know of an endpoint that fits this criteria, the admin can find such an endpoint on the remote Ceph cluster (via the tool box if it is a Rook Ceph Cluster) by running:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-1-1>1</a></span>
<span class=normal><a href=#__codelineno-1-2>2</a></span>
<span class=normal><a href=#__codelineno-1-3>3</a></span>
<span class=normal><a href=#__codelineno-1-4>4</a></span>
<span class=normal><a href=#__codelineno-1-5>5</a></span>
<span class=normal><a href=#__codelineno-1-6>6</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1></a><span class=gp>$ </span>radosgw-admin<span class=w> </span>zonegroup<span class=w> </span>get<span class=w> </span>--rgw-realm<span class=o>=</span><span class=nv>$REALM_NAME</span><span class=w> </span>--rgw-zonegroup<span class=o>=</span><span class=nv>$MASTER_ZONEGROUP_NAME</span>
<a id=__codelineno-1-2 name=__codelineno-1-2></a><span class=go>{</span>
<a id=__codelineno-1-3 name=__codelineno-1-3></a><span class=go>    ...</span>
<a id=__codelineno-1-4 name=__codelineno-1-4></a><span class=go>    &quot;endpoints&quot;: [http://10.17.159.77:80],</span>
<a id=__codelineno-1-5 name=__codelineno-1-5></a><span class=go>    ...</span>
<a id=__codelineno-1-6 name=__codelineno-1-6></a><span class=go>}</span>
</code></pre></div></td></tr></table></div> <p>A list of endpoints in the master zone group in the master zone is in the <code>endpoints</code> section of the JSON output of the <code>zonegoup get</code> command.</p> <p>This endpoint must also be resolvable from the new Rook Ceph cluster. To test this run the <code>curl</code> command on the endpoint:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-2-1>1</a></span>
<span class=normal><a href=#__codelineno-2-2>2</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1></a><span class=gp>$ </span>curl<span class=w> </span>-L<span class=w> </span>http://10.17.159.77:80
<a id=__codelineno-2-2 name=__codelineno-2-2></a><span class=go>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;ListAllMyBucketsResult xmlns=&quot;http://s3.amazonaws.com/doc/2006-03-01/&quot;&gt;&lt;Owner&gt;&lt;ID&gt;anonymous&lt;/ID&gt;&lt;DisplayName&gt;&lt;/DisplayName&gt;&lt;/Owner&gt;&lt;Buckets&gt;&lt;/Buckets&gt;&lt;/ListAllMyBucketsResult&gt;</span>
</code></pre></div></td></tr></table></div> <p>Finally add the endpoint to the <code>pull</code> section of the CephObjectRealm's spec. The CephObjectRealm should have the same name as the CephObjectRealm/Ceph realm it is pulling from.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-3-1>1</a></span>
<span class=normal><a href=#__codelineno-3-2>2</a></span>
<span class=normal><a href=#__codelineno-3-3>3</a></span>
<span class=normal><a href=#__codelineno-3-4>4</a></span>
<span class=normal><a href=#__codelineno-3-5>5</a></span>
<span class=normal><a href=#__codelineno-3-6>6</a></span>
<span class=normal><a href=#__codelineno-3-7>7</a></span>
<span class=normal><a href=#__codelineno-3-8>8</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ceph.rook.io/v1</span>
<a id=__codelineno-3-2 name=__codelineno-3-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">CephObjectRealm</span>
<a id=__codelineno-3-3 name=__codelineno-3-3></a><span class=nt>metadata</span><span class=p>:</span>
<a id=__codelineno-3-4 name=__codelineno-3-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">realm-a</span>
<a id=__codelineno-3-5 name=__codelineno-3-5></a><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rook-ceph</span>
<a id=__codelineno-3-6 name=__codelineno-3-6></a><span class=nt>spec</span><span class=p>:</span>
<a id=__codelineno-3-7 name=__codelineno-3-7></a><span class=w>  </span><span class=nt>pull</span><span class=p>:</span>
<a id=__codelineno-3-8 name=__codelineno-3-8></a><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">http://10.17.159.77:80</span>
</code></pre></div></td></tr></table></div> <h3 id=getting-realm-access-key-and-secret-key>Getting Realm Access Key and Secret Key<a class=headerlink href=#getting-realm-access-key-and-secret-key title="Permanent link">&para;</a></h3> <p>The access key and secret key of the system user are keys that allow other Ceph clusters to pull the realm of the system user.</p> <h4 id=getting-the-realm-access-key-and-secret-key-from-the-rook-ceph-cluster>Getting the Realm Access Key and Secret Key from the Rook Ceph Cluster<a class=headerlink href=#getting-the-realm-access-key-and-secret-key-from-the-rook-ceph-cluster title="Permanent link">&para;</a></h4> <h5 id=system-user-for-multisite>System User for Multisite<a class=headerlink href=#system-user-for-multisite title="Permanent link">&para;</a></h5> <p>When an admin creates a ceph-object-realm a system user automatically gets created for the realm with an access key and a secret key.</p> <p>This system user has the name "$REALM_NAME-system-user". For the example if realm name is <code>realm-a</code>, then uid for the system user is "realm-a-system-user".</p> <p>These keys for the user are exported as a kubernetes <a href=https://kubernetes.io/docs/concepts/configuration/secret/ >secret</a> called "$REALM_NAME-keys" (ex: realm-a-keys).</p> <p>This system user used by RGW internally for the data replication.</p> <h5 id=getting-keys-from-k8s-secret>Getting keys from k8s secret<a class=headerlink href=#getting-keys-from-k8s-secret title="Permanent link">&para;</a></h5> <p>To get these keys from the cluster the realm was originally created on, run:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-4-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1></a><span class=go>kubectl -n $ORIGINAL_CLUSTER_NAMESPACE get secrets realm-a-keys -o yaml &gt; realm-a-keys.yaml</span>
</code></pre></div></td></tr></table></div> <p>Edit the <code>realm-a-keys.yaml</code> file, and change the <code>namespace</code> with the namespace that the new Rook Ceph cluster exists in.</p> <p>Then create a kubernetes secret on the pulling Rook Ceph cluster with the same secrets yaml file.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-5-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1></a><span class=go>kubectl create -f realm-a-keys.yaml</span>
</code></pre></div></td></tr></table></div> <h4 id=getting-the-realm-access-key-and-secret-key-from-a-non-rook-ceph-cluster>Getting the Realm Access Key and Secret Key from a Non Rook Ceph Cluster<a class=headerlink href=#getting-the-realm-access-key-and-secret-key-from-a-non-rook-ceph-cluster title="Permanent link">&para;</a></h4> <p>The access key and the secret key of the system user can be found in the output of running the following command on a non-rook ceph cluster:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-6-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1></a><span class=go>radosgw-admin user info --uid=&quot;realm-a-system-user&quot;</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-7-1> 1</a></span>
<span class=normal><a href=#__codelineno-7-2> 2</a></span>
<span class=normal><a href=#__codelineno-7-3> 3</a></span>
<span class=normal><a href=#__codelineno-7-4> 4</a></span>
<span class=normal><a href=#__codelineno-7-5> 5</a></span>
<span class=normal><a href=#__codelineno-7-6> 6</a></span>
<span class=normal><a href=#__codelineno-7-7> 7</a></span>
<span class=normal><a href=#__codelineno-7-8> 8</a></span>
<span class=normal><a href=#__codelineno-7-9> 9</a></span>
<span class=normal><a href=#__codelineno-7-10>10</a></span>
<span class=normal><a href=#__codelineno-7-11>11</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1></a><span class=p>{</span>
<a id=__codelineno-7-2 name=__codelineno-7-2></a><span class=w>    </span><span class=err>...</span>
<a id=__codelineno-7-3 name=__codelineno-7-3></a><span class=w>    </span><span class=nt>&quot;keys&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<a id=__codelineno-7-4 name=__codelineno-7-4></a><span class=w>        </span><span class=p>{</span>
<a id=__codelineno-7-5 name=__codelineno-7-5></a><span class=w>            </span><span class=nt>&quot;user&quot;</span><span class=p>:</span><span class=w> </span><span class=nt>&quot;realm-a-system-user&quot;</span>
<a id=__codelineno-7-6 name=__codelineno-7-6></a><span class=w>            </span><span class=nt>&quot;access_key&quot;</span><span class=p>:</span><span class=w> </span><span class=nt>&quot;aSw4blZIKV9nKEU5VC0=&quot;</span>
<a id=__codelineno-7-7 name=__codelineno-7-7></a><span class=w>            </span><span class=nt>&quot;secret_key&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;JSlDXFt5TlgjSV9QOE9XUndrLiI5JEo9YDBsJg==&quot;</span><span class=p>,</span>
<a id=__codelineno-7-8 name=__codelineno-7-8></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-7-9 name=__codelineno-7-9></a><span class=w>    </span><span class=p>],</span>
<a id=__codelineno-7-10 name=__codelineno-7-10></a><span class=w>    </span><span class=err>...</span>
<a id=__codelineno-7-11 name=__codelineno-7-11></a><span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Then base64 encode the each of the keys and create a <code>.yaml</code> file for the Kubernetes secret from the following template.</p> <p>Only the <code>access-key</code>, <code>secret-key</code>, and <code>namespace</code> sections need to be replaced.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-8-1>1</a></span>
<span class=normal><a href=#__codelineno-8-2>2</a></span>
<span class=normal><a href=#__codelineno-8-3>3</a></span>
<span class=normal><a href=#__codelineno-8-4>4</a></span>
<span class=normal><a href=#__codelineno-8-5>5</a></span>
<span class=normal><a href=#__codelineno-8-6>6</a></span>
<span class=normal><a href=#__codelineno-8-7>7</a></span>
<span class=normal><a href=#__codelineno-8-8>8</a></span>
<span class=normal><a href=#__codelineno-8-9>9</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<a id=__codelineno-8-2 name=__codelineno-8-2></a><span class=nt>data</span><span class=p>:</span>
<a id=__codelineno-8-3 name=__codelineno-8-3></a><span class=w>  </span><span class=nt>access-key</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">YVN3NGJsWklLVjluS0VVNVZDMD0=</span>
<a id=__codelineno-8-4 name=__codelineno-8-4></a><span class=w>  </span><span class=nt>secret-key</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">SlNsRFhGdDVUbGdqU1Y5UU9FOVhVbmRyTGlJNUpFbzlZREJzSmc9PQ==</span>
<a id=__codelineno-8-5 name=__codelineno-8-5></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Secret</span>
<a id=__codelineno-8-6 name=__codelineno-8-6></a><span class=nt>metadata</span><span class=p>:</span>
<a id=__codelineno-8-7 name=__codelineno-8-7></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">realm-a-keys</span>
<a id=__codelineno-8-8 name=__codelineno-8-8></a><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">$NEW_ROOK_CLUSTER_NAMESPACE</span>
<a id=__codelineno-8-9 name=__codelineno-8-9></a><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">kubernetes.io/rook</span>
</code></pre></div></td></tr></table></div> <p>Finally, create a kubernetes secret on the pulling Rook Ceph cluster with the new secrets yaml file.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-9-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1></a><span class=go>kubectl create -f realm-a-keys.yaml</span>
</code></pre></div></td></tr></table></div> <h4 id=pulling-a-realm-on-a-new-rook-ceph-cluster>Pulling a Realm on a New Rook Ceph Cluster<a class=headerlink href=#pulling-a-realm-on-a-new-rook-ceph-cluster title="Permanent link">&para;</a></h4> <p>Once the admin knows the endpoint and the secret for the keys has been created, the admin should create:</p> <ol> <li>A <a href=../../../CRDs/Object-Storage/ceph-object-realm-crd/#settings>CephObjectRealm</a> matching to the realm on the other Ceph cluster, with an endpoint as described above.</li> <li>A <a href=../../../CRDs/Object-Storage/ceph-object-zonegroup-crd/#settings>CephObjectZoneGroup</a> matching the master zone group name or the master CephObjectZoneGroup from the cluster the realm was pulled from.</li> <li>A <a href=../../../CRDs/Object-Storage/ceph-object-zone-crd/#settings>CephObjectZone</a> referring to the CephObjectZoneGroup created above.</li> <li>A CephObjectStore referring to the new CephObjectZone resource.</li> </ol> <p>object-multisite-pull-realm.yaml (with changes) in the <a href=https://github.com/rook/rook/blob/HEAD/deploy/examples/ >examples</a> directory can be used to create the multisite CRDs.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-10-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1></a><span class=go>kubectl create -f object-multisite-pull-realm.yaml</span>
</code></pre></div></td></tr></table></div> <h2 id=scaling-a-multisite>Scaling a Multisite<a class=headerlink href=#scaling-a-multisite title="Permanent link">&para;</a></h2> <p>Scaling the number of gateways that run the synchronization thread to 2 or more can increase the latency of the replication of each S3 object. The recommended way to scale a mutisite configuration is to dissociate the gateway dedicated to the synchronization from gateways that serve clients.</p> <p>The two types of gateways can be deployed by creating two CephObjectStores associated with the same CephObjectZone. The objectstore that deploys the gateway dedicated to the synchronization must have <code>spec.gateway.instances</code> set to <code>1</code>, while the objectstore that deploys the client gateways have multiple replicas and should disable the synchronization thread on the gateways by setting <code>spec.gateway.disableMultisiteSyncTraffic</code> to <code>true</code>.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-11-1> 1</a></span>
<span class=normal><a href=#__codelineno-11-2> 2</a></span>
<span class=normal><a href=#__codelineno-11-3> 3</a></span>
<span class=normal><a href=#__codelineno-11-4> 4</a></span>
<span class=normal><a href=#__codelineno-11-5> 5</a></span>
<span class=normal><a href=#__codelineno-11-6> 6</a></span>
<span class=normal><a href=#__codelineno-11-7> 7</a></span>
<span class=normal><a href=#__codelineno-11-8> 8</a></span>
<span class=normal><a href=#__codelineno-11-9> 9</a></span>
<span class=normal><a href=#__codelineno-11-10>10</a></span>
<span class=normal><a href=#__codelineno-11-11>11</a></span>
<span class=normal><a href=#__codelineno-11-12>12</a></span>
<span class=normal><a href=#__codelineno-11-13>13</a></span>
<span class=normal><a href=#__codelineno-11-14>14</a></span>
<span class=normal><a href=#__codelineno-11-15>15</a></span>
<span class=normal><a href=#__codelineno-11-16>16</a></span>
<span class=normal><a href=#__codelineno-11-17>17</a></span>
<span class=normal><a href=#__codelineno-11-18>18</a></span>
<span class=normal><a href=#__codelineno-11-19>19</a></span>
<span class=normal><a href=#__codelineno-11-20>20</a></span>
<span class=normal><a href=#__codelineno-11-21>21</a></span>
<span class=normal><a href=#__codelineno-11-22>22</a></span>
<span class=normal><a href=#__codelineno-11-23>23</a></span>
<span class=normal><a href=#__codelineno-11-24>24</a></span>
<span class=normal><a href=#__codelineno-11-25>25</a></span>
<span class=normal><a href=#__codelineno-11-26>26</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1></a><span class=nn>---</span>
<a id=__codelineno-11-2 name=__codelineno-11-2></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ceph.rook.io/v1</span>
<a id=__codelineno-11-3 name=__codelineno-11-3></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">CephObjectStore</span>
<a id=__codelineno-11-4 name=__codelineno-11-4></a><span class=nt>metadata</span><span class=p>:</span>
<a id=__codelineno-11-5 name=__codelineno-11-5></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">replication</span>
<a id=__codelineno-11-6 name=__codelineno-11-6></a><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rook-ceph</span>
<a id=__codelineno-11-7 name=__codelineno-11-7></a><span class=nt>spec</span><span class=p>:</span>
<a id=__codelineno-11-8 name=__codelineno-11-8></a><span class=w>  </span><span class=nt>gateway</span><span class=p>:</span>
<a id=__codelineno-11-9 name=__codelineno-11-9></a><span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<a id=__codelineno-11-10 name=__codelineno-11-10></a><span class=w>    </span><span class=nt>instances</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<a id=__codelineno-11-11 name=__codelineno-11-11></a><span class=w>    </span><span class=nt>disableMultisiteSyncTraffic</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<a id=__codelineno-11-12 name=__codelineno-11-12></a><span class=w>  </span><span class=nt>zone</span><span class=p>:</span>
<a id=__codelineno-11-13 name=__codelineno-11-13></a><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">zone-a</span>
<a id=__codelineno-11-14 name=__codelineno-11-14></a><span class=nn>---</span>
<a id=__codelineno-11-15 name=__codelineno-11-15></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ceph.rook.io/v1</span>
<a id=__codelineno-11-16 name=__codelineno-11-16></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">CephObjectStore</span>
<a id=__codelineno-11-17 name=__codelineno-11-17></a><span class=nt>metadata</span><span class=p>:</span>
<a id=__codelineno-11-18 name=__codelineno-11-18></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">clients</span>
<a id=__codelineno-11-19 name=__codelineno-11-19></a><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rook-ceph</span>
<a id=__codelineno-11-20 name=__codelineno-11-20></a><span class=nt>spec</span><span class=p>:</span>
<a id=__codelineno-11-21 name=__codelineno-11-21></a><span class=w>  </span><span class=nt>gateway</span><span class=p>:</span>
<a id=__codelineno-11-22 name=__codelineno-11-22></a><span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<a id=__codelineno-11-23 name=__codelineno-11-23></a><span class=w>    </span><span class=nt>instances</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<a id=__codelineno-11-24 name=__codelineno-11-24></a><span class=w>    </span><span class=nt>disableMultisiteSyncTraffic</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id=__codelineno-11-25 name=__codelineno-11-25></a><span class=w>  </span><span class=nt>zone</span><span class=p>:</span>
<a id=__codelineno-11-26 name=__codelineno-11-26></a><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">zone-a</span>
</code></pre></div></td></tr></table></div> <h2 id=multisite-cleanup>Multisite Cleanup<a class=headerlink href=#multisite-cleanup title="Permanent link">&para;</a></h2> <p>Multisite configuration must be cleaned up by hand. Deleting a realm/zone group/zone CR will not delete the underlying Ceph realm, zone group, zone, or the pools associated with a zone.</p> <h3 id=realm-deletion>Realm Deletion<a class=headerlink href=#realm-deletion title="Permanent link">&para;</a></h3> <p>Changes made to the resource's configuration or deletion of the resource are not reflected on the Ceph cluster.</p> <p>When the ceph-object-realm resource is deleted or modified, the realm is not deleted from the Ceph cluster. Realm deletion must be done via the toolbox.</p> <h4 id=deleting-a-realm>Deleting a Realm<a class=headerlink href=#deleting-a-realm title="Permanent link">&para;</a></h4> <p>The Rook toolbox can modify the Ceph Multisite state via the radosgw-admin command.</p> <p>The following command, run via the toolbox, deletes the realm.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-12-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1></a><span class=go>radosgw-admin realm delete --rgw-realm=realm-a</span>
</code></pre></div></td></tr></table></div> <h3 id=zone-group-deletion>Zone Group Deletion<a class=headerlink href=#zone-group-deletion title="Permanent link">&para;</a></h3> <p>Changes made to the resource's configuration or deletion of the resource are not reflected on the Ceph cluster.</p> <p>When the ceph-object-zone group resource is deleted or modified, the zone group is not deleted from the Ceph cluster. Zone Group deletion must be done through the toolbox.</p> <h4 id=deleting-a-zone-group>Deleting a Zone Group<a class=headerlink href=#deleting-a-zone-group title="Permanent link">&para;</a></h4> <p>The Rook toolbox can modify the Ceph Multisite state via the radosgw-admin command.</p> <p>The following command, run via the toolbox, deletes the zone group.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-13-1>1</a></span>
<span class=normal><a href=#__codelineno-13-2>2</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1></a><span class=go>radosgw-admin zonegroup delete --rgw-realm=realm-a --rgw-zonegroup=zone-group-a</span>
<a id=__codelineno-13-2 name=__codelineno-13-2></a><span class=go>radosgw-admin period update --commit --rgw-realm=realm-a --rgw-zonegroup=zone-group-a</span>
</code></pre></div></td></tr></table></div> <h3 id=deleting-and-reconfiguring-the-ceph-object-zone>Deleting and Reconfiguring the Ceph Object Zone<a class=headerlink href=#deleting-and-reconfiguring-the-ceph-object-zone title="Permanent link">&para;</a></h3> <p>Changes made to the resource's configuration or deletion of the resource are not reflected on the Ceph cluster.</p> <p>When the ceph-object-zone resource is deleted or modified, the zone is not deleted from the Ceph cluster. Zone deletion must be done through the toolbox.</p> <h4 id=changing-the-master-zone>Changing the Master Zone<a class=headerlink href=#changing-the-master-zone title="Permanent link">&para;</a></h4> <p>The Rook toolbox can change the master zone in a zone group.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-14-1>1</a></span>
<span class=normal><a href=#__codelineno-14-2>2</a></span>
<span class=normal><a href=#__codelineno-14-3>3</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1></a><span class=go>radosgw-admin zone modify --rgw-realm=realm-a --rgw-zonegroup=zone-group-a --rgw-zone=zone-a --master</span>
<a id=__codelineno-14-2 name=__codelineno-14-2></a><span class=go>radosgw-admin zonegroup modify --rgw-realm=realm-a --rgw-zonegroup=zone-group-a --master</span>
<a id=__codelineno-14-3 name=__codelineno-14-3></a><span class=go>radosgw-admin period update --commit --rgw-realm=realm-a --rgw-zonegroup=zone-group-a --rgw-zone=zone-a</span>
</code></pre></div></td></tr></table></div> <h4 id=deleting-zone>Deleting Zone<a class=headerlink href=#deleting-zone title="Permanent link">&para;</a></h4> <p>The Rook toolbox can modify the Ceph Multisite state via the radosgw-admin command.</p> <p>There are two scenarios possible when deleting a zone. The following commands, run via the toolbox, deletes the zone if there is only one zone in the zone group.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-15-1>1</a></span>
<span class=normal><a href=#__codelineno-15-2>2</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1></a><span class=go>radosgw-admin zone delete --rgw-realm=realm-a --rgw-zonegroup=zone-group-a --rgw-zone=zone-a</span>
<a id=__codelineno-15-2 name=__codelineno-15-2></a><span class=go>radosgw-admin period update --commit --rgw-realm=realm-a --rgw-zonegroup=zone-group-a --rgw-zone=zone-a</span>
</code></pre></div></td></tr></table></div> <p>In the other scenario, there are more than one zones in a zone group.</p> <p>Care must be taken when changing which zone is the master zone.</p> <p>Please read the following <a href=https://docs.ceph.com/docs/master/radosgw/multisite/#changing-the-metadata-master-zone>documentation</a> before running the below commands:</p> <p>The following commands, run via toolboxes, remove the zone from the zone group first, then delete the zone.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-16-1>1</a></span>
<span class=normal><a href=#__codelineno-16-2>2</a></span>
<span class=normal><a href=#__codelineno-16-3>3</a></span>
<span class=normal><a href=#__codelineno-16-4>4</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1></a><span class=go>radosgw-admin zonegroup rm --rgw-realm=realm-a --rgw-zonegroup=zone-group-a --rgw-zone=zone-a</span>
<a id=__codelineno-16-2 name=__codelineno-16-2></a><span class=go>radosgw-admin period update --commit --rgw-realm=realm-a --rgw-zonegroup=zone-group-a --rgw-zone=zone-a</span>
<a id=__codelineno-16-3 name=__codelineno-16-3></a><span class=go>radosgw-admin zone delete --rgw-realm=realm-a --rgw-zonegroup=zone-group-a --rgw-zone=zone-a</span>
<a id=__codelineno-16-4 name=__codelineno-16-4></a><span class=go>radosgw-admin period update --commit --rgw-realm=realm-a --rgw-zonegroup=zone-group-a --rgw-zone=zone-a</span>
</code></pre></div></td></tr></table></div> <p>When a zone is deleted, the pools for that zone are not deleted.</p> <h4 id=deleting-pools-for-a-zone>Deleting Pools for a Zone<a class=headerlink href=#deleting-pools-for-a-zone title="Permanent link">&para;</a></h4> <p>The Rook toolbox can delete pools. Deleting pools should be done with caution.</p> <p>The following <a href=https://docs.ceph.com/docs/master/rados/operations/pools/ >documentation</a> on pools should be read before deleting any pools.</p> <p>When a zone is created the following pools are created for each zone:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-17-1>1</a></span>
<span class=normal><a href=#__codelineno-17-2>2</a></span>
<span class=normal><a href=#__codelineno-17-3>3</a></span>
<span class=normal><a href=#__codelineno-17-4>4</a></span>
<span class=normal><a href=#__codelineno-17-5>5</a></span>
<span class=normal><a href=#__codelineno-17-6>6</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1></a><span class=gp>$</span>ZONE_NAME.rgw.control
<a id=__codelineno-17-2 name=__codelineno-17-2></a><span class=gp>$</span>ZONE_NAME.rgw.meta
<a id=__codelineno-17-3 name=__codelineno-17-3></a><span class=gp>$</span>ZONE_NAME.rgw.log
<a id=__codelineno-17-4 name=__codelineno-17-4></a><span class=gp>$</span>ZONE_NAME.rgw.buckets.index
<a id=__codelineno-17-5 name=__codelineno-17-5></a><span class=gp>$</span>ZONE_NAME.rgw.buckets.non-ec
<a id=__codelineno-17-6 name=__codelineno-17-6></a><span class=gp>$</span>ZONE_NAME.rgw.buckets.data
</code></pre></div></td></tr></table></div> <p>Here is an example command to delete the .rgw.buckets.data pool for zone-a.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-18-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1></a><span class=go>ceph osd pool rm zone-a.rgw.buckets.data zone-a.rgw.buckets.data --yes-i-really-really-mean-it</span>
</code></pre></div></td></tr></table></div> <p>In this command the pool name <strong>must</strong> be mentioned twice for the pool to be removed.</p> <h4 id=removing-an-object-store-from-a-zone>Removing an Object Store from a Zone<a class=headerlink href=#removing-an-object-store-from-a-zone title="Permanent link">&para;</a></h4> <p>When an object-store (created in a zone) is deleted, the endpoint for that object store is removed from that zone, via</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-19-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1></a><span class=go>kubectl delete -f object-store.yaml</span>
</code></pre></div></td></tr></table></div> <p>Removing object store(s) from the master zone of the master zone group should be done with caution. When all of these object-stores are deleted the period cannot be updated and that realm cannot be pulled.</p> <h2 id=configure-an-existing-object-store-for-multisite>Configure an Existing Object Store for Multisite<a class=headerlink href=#configure-an-existing-object-store-for-multisite title="Permanent link">&para;</a></h2> <p>When an object store is configured by Rook, it internally creates a zone, zone group, and realm with the same name as the object store. To enable multisite, you will need to create the corresponding zone, zone group, and realm CRs with the same name as the object store. For example, to create multisite CRs for an object store named <code>my-store</code>: <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-20-1> 1</a></span>
<span class=normal><a href=#__codelineno-20-2> 2</a></span>
<span class=normal><a href=#__codelineno-20-3> 3</a></span>
<span class=normal><a href=#__codelineno-20-4> 4</a></span>
<span class=normal><a href=#__codelineno-20-5> 5</a></span>
<span class=normal><a href=#__codelineno-20-6> 6</a></span>
<span class=normal><a href=#__codelineno-20-7> 7</a></span>
<span class=normal><a href=#__codelineno-20-8> 8</a></span>
<span class=normal><a href=#__codelineno-20-9> 9</a></span>
<span class=normal><a href=#__codelineno-20-10>10</a></span>
<span class=normal><a href=#__codelineno-20-11>11</a></span>
<span class=normal><a href=#__codelineno-20-12>12</a></span>
<span class=normal><a href=#__codelineno-20-13>13</a></span>
<span class=normal><a href=#__codelineno-20-14>14</a></span>
<span class=normal><a href=#__codelineno-20-15>15</a></span>
<span class=normal><a href=#__codelineno-20-16>16</a></span>
<span class=normal><a href=#__codelineno-20-17>17</a></span>
<span class=normal><a href=#__codelineno-20-18>18</a></span>
<span class=normal><a href=#__codelineno-20-19>19</a></span>
<span class=normal><a href=#__codelineno-20-20>20</a></span>
<span class=normal><a href=#__codelineno-20-21>21</a></span>
<span class=normal><a href=#__codelineno-20-22>22</a></span>
<span class=normal><a href=#__codelineno-20-23>23</a></span>
<span class=normal><a href=#__codelineno-20-24>24</a></span>
<span class=normal><a href=#__codelineno-20-25>25</a></span>
<span class=normal><a href=#__codelineno-20-26>26</a></span>
<span class=normal><a href=#__codelineno-20-27>27</a></span>
<span class=normal><a href=#__codelineno-20-28>28</a></span>
<span class=normal><a href=#__codelineno-20-29>29</a></span>
<span class=normal><a href=#__codelineno-20-30>30</a></span>
<span class=normal><a href=#__codelineno-20-31>31</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ceph.rook.io/v1</span>
<a id=__codelineno-20-2 name=__codelineno-20-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">CephObjectRealm</span>
<a id=__codelineno-20-3 name=__codelineno-20-3></a><span class=nt>metadata</span><span class=p>:</span>
<a id=__codelineno-20-4 name=__codelineno-20-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my-store</span>
<a id=__codelineno-20-5 name=__codelineno-20-5></a><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rook-ceph</span><span class=w> </span><span class=c1># namespace:cluster</span>
<a id=__codelineno-20-6 name=__codelineno-20-6></a><span class=nn>---</span>
<a id=__codelineno-20-7 name=__codelineno-20-7></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ceph.rook.io/v1</span>
<a id=__codelineno-20-8 name=__codelineno-20-8></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">CephObjectZoneGroup</span>
<a id=__codelineno-20-9 name=__codelineno-20-9></a><span class=nt>metadata</span><span class=p>:</span>
<a id=__codelineno-20-10 name=__codelineno-20-10></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my-store</span>
<a id=__codelineno-20-11 name=__codelineno-20-11></a><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rook-ceph</span><span class=w> </span><span class=c1># namespace:cluster</span>
<a id=__codelineno-20-12 name=__codelineno-20-12></a><span class=nt>spec</span><span class=p>:</span>
<a id=__codelineno-20-13 name=__codelineno-20-13></a><span class=w>  </span><span class=nt>realm</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my-store</span>
<a id=__codelineno-20-14 name=__codelineno-20-14></a><span class=nn>---</span>
<a id=__codelineno-20-15 name=__codelineno-20-15></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ceph.rook.io/v1</span>
<a id=__codelineno-20-16 name=__codelineno-20-16></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">CephObjectZone</span>
<a id=__codelineno-20-17 name=__codelineno-20-17></a><span class=nt>metadata</span><span class=p>:</span>
<a id=__codelineno-20-18 name=__codelineno-20-18></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my-store</span>
<a id=__codelineno-20-19 name=__codelineno-20-19></a><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rook-ceph</span><span class=w> </span><span class=c1># namespace:cluster</span>
<a id=__codelineno-20-20 name=__codelineno-20-20></a><span class=nt>spec</span><span class=p>:</span>
<a id=__codelineno-20-21 name=__codelineno-20-21></a><span class=w>  </span><span class=nt>zoneGroup</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my-store</span>
<a id=__codelineno-20-22 name=__codelineno-20-22></a><span class=w>  </span><span class=nt>metadataPool</span><span class=p>:</span>
<a id=__codelineno-20-23 name=__codelineno-20-23></a><span class=w>    </span><span class=nt>replicated</span><span class=p>:</span>
<a id=__codelineno-20-24 name=__codelineno-20-24></a><span class=w>      </span><span class=nt>size</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<a id=__codelineno-20-25 name=__codelineno-20-25></a><span class=w>  </span><span class=nt>dataPool</span><span class=p>:</span>
<a id=__codelineno-20-26 name=__codelineno-20-26></a><span class=w>    </span><span class=nt>replicated</span><span class=p>:</span>
<a id=__codelineno-20-27 name=__codelineno-20-27></a><span class=w>      </span><span class=nt>size</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<a id=__codelineno-20-28 name=__codelineno-20-28></a><span class=w>  </span><span class=nt>preservePoolsOnDelete</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<a id=__codelineno-20-29 name=__codelineno-20-29></a><span class=w>  </span><span class=c1># recommended to set this value if ingress used for exposing rgw endpoints</span>
<a id=__codelineno-20-30 name=__codelineno-20-30></a><span class=w>  </span><span class=c1># customEndpoints:</span>
<a id=__codelineno-20-31 name=__codelineno-20-31></a><span class=w>  </span><span class=c1>#   - &quot;http://rgw-a.fqdn&quot;</span>
</code></pre></div></td></tr></table></div></p> <p>Now modify the existing <code>CephObjectStore</code> CR to exclude pool settings and add a reference to the zone.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-21-1> 1</a></span>
<span class=normal><a href=#__codelineno-21-2> 2</a></span>
<span class=normal><a href=#__codelineno-21-3> 3</a></span>
<span class=normal><a href=#__codelineno-21-4> 4</a></span>
<span class=normal><a href=#__codelineno-21-5> 5</a></span>
<span class=normal><a href=#__codelineno-21-6> 6</a></span>
<span class=normal><a href=#__codelineno-21-7> 7</a></span>
<span class=normal><a href=#__codelineno-21-8> 8</a></span>
<span class=normal><a href=#__codelineno-21-9> 9</a></span>
<span class=normal><a href=#__codelineno-21-10>10</a></span>
<span class=normal><a href=#__codelineno-21-11>11</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ceph.rook.io/v1</span>
<a id=__codelineno-21-2 name=__codelineno-21-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">CephObjectStore</span>
<a id=__codelineno-21-3 name=__codelineno-21-3></a><span class=nt>metadata</span><span class=p>:</span>
<a id=__codelineno-21-4 name=__codelineno-21-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my-store</span>
<a id=__codelineno-21-5 name=__codelineno-21-5></a><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rook-ceph</span><span class=w> </span><span class=c1># namespace:cluster</span>
<a id=__codelineno-21-6 name=__codelineno-21-6></a><span class=nt>spec</span><span class=p>:</span>
<a id=__codelineno-21-7 name=__codelineno-21-7></a><span class=w>  </span><span class=nt>gateway</span><span class=p>:</span>
<a id=__codelineno-21-8 name=__codelineno-21-8></a><span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<a id=__codelineno-21-9 name=__codelineno-21-9></a><span class=w>    </span><span class=nt>instances</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<a id=__codelineno-21-10 name=__codelineno-21-10></a><span class=w>  </span><span class=nt>zone</span><span class=p>:</span>
<a id=__codelineno-21-11 name=__codelineno-21-11></a><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my-store</span>
</code></pre></div></td></tr></table></div> <h4 id=using-custom-names>Using custom names<a class=headerlink href=#using-custom-names title="Permanent link">&para;</a></h4> <p>If names different from the object store need to be set for the realm, zone, or zone group, first rename them in the backend via toolbox pod, then following the procedure above. <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-22-1>1</a></span>
<span class=normal><a href=#__codelineno-22-2>2</a></span>
<span class=normal><a href=#__codelineno-22-3>3</a></span>
<span class=normal><a href=#__codelineno-22-4>4</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1></a><span class=go>radosgw-admin realm rename --rgw-realm=my-store --realm-new-name=&lt;new-realm-name&gt;</span>
<a id=__codelineno-22-2 name=__codelineno-22-2></a><span class=go>radosgw-admin zonegroup rename --rgw-zonegroup=my-store --zonegroup-new-name=&lt;new-zonegroup-name&gt; --rgw-realm=&lt;new-realm-name&gt;</span>
<a id=__codelineno-22-3 name=__codelineno-22-3></a><span class=go>radosgw-admin zone rename --rgw-zone=my-store --zone-new-name=&lt;new-zone-name&gt;  --rgw-zonegroup=&lt;new-zonegroup-name&gt; --rgw-realm=&lt;new-realm-name&gt;</span>
<a id=__codelineno-22-4 name=__codelineno-22-4></a><span class=go>radosgw-admin period update --commit</span>
</code></pre></div></td></tr></table></div></p> <div class="admonition important"> <p class=admonition-title>Important</p> <p>Renaming in the toolbox must be performed <strong>before</strong> creating the multisite CRs</p> </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../ceph-object-bucket-notifications/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Object Bucket Notifications" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Object Bucket Notifications </div> </div> </a> <a href=../cosi/ class="md-footer__link md-footer__link--next" aria-label="Next: Container Object Storage Interface (COSI)" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Container Object Storage Interface (COSI) </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> <a href=/ class=logo> <img src=https://rook.io/images/rook-logo-small.svg alt="rook.io logo"> </a> <p> &#169; Rook Authors 2022. Documentation distributed under <a href=https://creativecommons.org/licenses/by/4.0>CC-BY-4.0</a>. </p> <p> &#169; 2022 The Linux Foundation. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href=https://www.linuxfoundation.org/trademark-usage/ >Trademark Usage</a> page. </p> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://slack.rook.io/ target=_blank rel=noopener title=slack.rook.io class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"/></svg> </a> <a href=https://twitter.com/rook_io target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> <a href=https://groups.google.com/forum/#!forum/rook-dev target=_blank rel=noopener title=groups.google.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M96 0C78.3 0 64 14.3 64 32v192h96v-32c0-35.3 28.7-64 64-64h224V32c0-17.7-14.3-32-32-32H96zm128 160c-17.7 0-32 14.3-32 32v32h96c35.3 0 64 28.7 64 64v128h192c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32H224zm240 64h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16h-32c-8.8 0-16-7.2-16-16v-32c0-8.8 7.2-16 16-16zM32 256c-17.7 0-32 14.3-32 32v13l155.1 114.9c1.4 1 3.1 1.6 4.9 1.6s3.5-.6 4.9-1.6L320 301v-13c0-17.7-14.3-32-32-32H32zm288 84.8L184 441.6c-6.9 5.1-15.3 7.9-24 7.9s-17-2.8-24-7.9L0 340.8V480c0 17.7 14.3 32 32 32h256c17.7 0 32-14.3 32-32V340.8z"/></svg> </a> <a href=https://blog.rook.io/ target=_blank rel=noopener title=blog.rook.io class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M180.5 74.262C80.813 74.262 0 155.633 0 256s80.819 181.738 180.5 181.738S361 356.373 361 256 280.191 74.262 180.5 74.262Zm288.25 10.646c-49.845 0-90.245 76.619-90.245 171.095s40.406 171.1 90.251 171.1 90.251-76.619 90.251-171.1H559c0-94.503-40.4-171.095-90.248-171.095Zm139.506 17.821c-17.526 0-31.735 68.628-31.735 153.274s14.2 153.274 31.735 153.274S640 340.631 640 256c0-84.649-14.215-153.271-31.742-153.271Z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.tabs.link", "instant", "navigation.expand", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "tabs"], "search": "../../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"default": "latest-release", "provider": "mike"}}</script> <script src=../../../assets/javascripts/bundle.5a2dcb6a.min.js></script> </body> </html>